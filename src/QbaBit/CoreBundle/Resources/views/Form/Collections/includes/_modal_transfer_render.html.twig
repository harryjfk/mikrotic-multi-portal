{% if add is defined %}
<input id="{{ form.vars.id }}" name="{{ form.vars.full_name }}[value]" style="display: none" value="{{ form.vars.data!=null?form.vars.data.value }}">

{% else %}


<div class="row">
    {% set height = form.vars.height-160  %}
    <div class="col-xs-7" style="overflow:scroll;height: {{ height }}px">


        {% for i in form.children %}
            {% if i.vars.name!='value' %}
                {{ form(i) }}
            {% endif %}
        {% endfor %}
    </div>
    <div class="col-xs-1">
        <button type="button" class="btn btn-primary" style="margin-top: 200px" id="transfer_{{ form.vars.id }}"><i
                    class="fa  fa-arrow-right"></i></button>
    </div>
    <div class="col-xs-4">
        <div class="box box-primary">
            <div class="box-body">
                {{ form(form.children.value) }}
                <style>
                    #{{ form.children.value.vars.id }} {
                        height: {{ height-70 }}px;
                    }
                    .ui-button-text-only .ui-button-text
                    {
                        padding: 0 !important;
                    }
                </style>

            </div>

        </div>

    </div>
</div>

<script>

    function onOk{{ form.vars.id }}(e)
    {

        {{ form.vars.id }}.value =  {{ form.children.value.vars.id }}_control.saveToJson();


    }
    function onChildListLoad{{ form.vars.id }}_value(e)
    {
        try
        {
            {{ form.children.value.vars.id }}_control.loadFromJson({{ form.vars.id }}.value);
        }
        catch (e){}

    }

    $(function () {

        $('#transfer_{{ form.vars.id }}').on('click', function (w) {

            var checks = $('#{{ form.vars.id }}_modal input[type="checkbox"]');
            for (var i = 0; i < checks.length; i++)
                if (checks[i].checked == true) {
                    var value = $(checks[i]).attr("data-id");

                    if(value!=-1)
                    {
                        var name = $(checks[i]).parent().parent().parent().parent().parent().prev();
                        var id = name.attr("data-id");
                        var text = $(checks[i]).parent().parent().next().html();
                        var g = name.html();

                        {{ form.children.value.vars.id }}_control.add(text, value, g, id);

                    }


                }
        });



    });


</script>

{% endif %}