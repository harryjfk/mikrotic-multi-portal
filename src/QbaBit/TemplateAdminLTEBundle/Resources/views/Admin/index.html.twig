
{% extends template_helper.getRedirectedView("QbaBitCoreBundle:Layout:_layout.html.twig") %}

{% block breadcumb %} {% endblock %}
{% block title %} {{ 'qba_bit.nauta.title'|trans }}{% endblock %}

{% block update %}





    <div class="row">
        <div class="col-md-12">


            <!-- AREA CHART -->
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">Pagos realizados</h3>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    {{ form(graph.payments) }}
                </div>
                <!-- /.box-body -->
            </div>
        </div>
        <div class="col-md-12">
            <!-- /.box -->

            <!-- DONUT CHART -->
            <div class="box box-danger">
                <div class="box-header with-border">
                    <h3 class="box-title">Clientes sin pagar</h3>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>
                <div class="box-body">

                    <table class="highchart table table-hover table-bordered">
                        <thead>
                        <tr>
                            <th>Cliente</th>
                            <th>A Pagar</th>
                            <th>Fecha de vencimiento</th>
                            <th>Pagar</th>
                        </tr>
                        </thead>
                        <tbody>
                         {%  for c in data.missing %}
                        <tr>
                            <td>{{ c.name }}</td>

                                 <td>{{ c.value }}</td>
                                 <td>{{ c.last_time }}</td>
                            <td>
                                <button class="btn btn-primary pay-button" data-name="{{ c.id }}">
                                    <i class="fa fa-paypal"></i>
                                </button>
                            </td>
                             </tr>
                        {% endfor %}
                        </tbody>


                    </table>
                    <script>
                        $(".pay-button").on("click",function(e){
                           e.stopPropagation();
                           e.preventDefault();
                           console.log("aaa");
                           var t = $(e.target).data("name");
                           if(t ==null)
                               t = $(e.target).parent().data("name")
                           var u ="{{ url("qba_bit_nauta_admin_pay",{"id":-1}) }}".replace("-1",t);
                            $.ajax({
                                url: u ,
                                /* method:method,*/
                                data: null,
                                type: "GET",
                                /*  dataType : 'html',*/
                                enctype: 'multipart/form-data',
                                success: function(e){
                                    document.location.href = "{{ url("qba_bit_nauta_admin_homepage") }}";
                                },
                                error: function(e){
                                    alert("Existen errores");
                                },
                                processData: false,
                                contentType: false

                            });
                        });
                    </script>
                </div>
                <!-- /.box-body -->
            </div>
            <!-- /.box -->

        </div>
        <!-- /.col (LEFT) -->
        <div class="col-md-12">
            <!-- LINE CHART -->
            <div class="box box-info">
                <div class="box-header with-border">
                    <h3 class="box-title">Cobro entre socios</h3>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <div class="chart">
                        {{ form(graph.admins) }}
                    </div>
                </div>
                <!-- /.box-body -->
            </div>
            <!-- /.box -->

            <!-- /.box -->

        </div>
        <!-- /.col (RIGHT) -->
    </div>

{% endblock %}

